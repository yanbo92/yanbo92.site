<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>腾讯性能狗收费之后，我写了一款iOS性能测试工具 | 茅测顿开</title><meta name=keywords content="github,ios,开源项目,tidevice,iPhone,性能测试,grafana,mysql"><meta name=description content="运行效果 项目介绍 项目地址：yanbo92/iOS-perf
性能测试一直是APP测试的一个重要部分，而在Android上由于系统的开放特性，相关工具支持比较多，比如solopi等。但在iOS上，腾讯家的perfdog本来还是十分好用的，但收费了就有点难受，而直接用Xcode的Instruments又对Mac有刚需，很难支撑公司的测试需求。此时看到这个贴子，上手跑了几次，还挺好用的，于是就顺着思路做了下去，有了这个比较完善的项目。
当前支持获取的性能数据包括GPU、CPU、内存、FPS、功耗、网络、温度，以及一系列手机硬件数据，并将根据需求继续新增。
本项目基于jlintxia开源的iOS测试方案修改而来，增加动态建表，动态增加grafana面板以及docker打包环境等特性。其中iOS性能数据来源于开源工具tidevice和py-ios-device。
注意：本项目依赖MySQL进行性能数据存储，Grafana进行数据动态展示，也就是说需要在本机或者可达的网络（比如公司局域网） 上搭建MySQL+Grafana服务，我提供了一份docker-compose.yml文件，可以使用docker快速搭建一套环境。
相关工具介绍 Grafana  Grafana是一个跨平台、开源的数据可视化网络应用程序平台。用户配置连接的数据源之后，Grafana可以在网络浏览器里显示数据图表和警告。该软件的企业版本提供更多的扩展功能。扩展功能通过插件的形式提供，终端用户可以自定义自己的数据面板界面以及数据请求方式。
 Mysql  MySQL原本是一个开放源码的关系数据库管理系统，原开发者为瑞典的MySQL AB公司，该公司于2008年被昇阳微系统收购。2009年，甲骨文公司收购昇阳微系统公司，MySQL成为Oracle旗下产品。
 py-ios-device  win，mac 跨平台方案，通过 Instruments 私有协议获取 iOS 相关性能指标数据。
相关文章链接:https://testerhome.com/topics/27159
 taobao-iphone-device  tidevice 是阿里的内部的一个小组用来做 iOS 自动化用的工具，通过逆向iOS通信协议，使用纯Python实现。目前淘宝和其他部分事业部已经全面使用了该技术，进行iOS应用的性能采集，UI自动化。
注：这里的被测应用无需做任何修改，使用不再局限于Mac上。
 使用步骤 准备工作 服务端搭建依赖docker以及docker-compose，安装指南：
 https://dockerdocs.cn/get-docker/
https://dockerdocs.cn/get-started/08_using_compose/
 运行测试依赖python3环境，安装指南：
 https://www.python.org/downloads/
 服务端搭建 命令行运行
docker -v && docker-compose -v 如果能正常输出版本，如下，则表示docker环境正常，可以继续
 Docker version 20.10.8, build 3967b7d
docker-compose version 1.29.2, build 5becea4c
 拉取镜像并启动服务：
docker-compose up -d 提示：初次打开Grafana时，系统会提示你修改密码，为了方便建议不修改，即保持账号密码均为admin，否则在python运行指令中将要进行对应的传参。"><meta name=author content="yanbo92"><link rel=canonical href=https://yanbo92.github.io/ios-perf/><link href=/assets/css/stylesheet.min.746a86b58bb2b052b5e4df8216510494f04f81e62c08d626150c26c69ca929da.css integrity="sha256-dGqGtYuysFK15N+CFlEElPBPgeYsCNYmFQwmxpypKdo=" rel="preload stylesheet" as=style><link rel=icon href=https://yanbo92.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://yanbo92.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://yanbo92.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://yanbo92.github.io/apple-touch-icon.png><link rel=mask-icon href=https://yanbo92.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.94.2"><meta property="og:title" content="腾讯性能狗收费之后，我写了一款iOS性能测试工具"><meta property="og:description" content="运行效果 项目介绍 项目地址：yanbo92/iOS-perf
性能测试一直是APP测试的一个重要部分，而在Android上由于系统的开放特性，相关工具支持比较多，比如solopi等。但在iOS上，腾讯家的perfdog本来还是十分好用的，但收费了就有点难受，而直接用Xcode的Instruments又对Mac有刚需，很难支撑公司的测试需求。此时看到这个贴子，上手跑了几次，还挺好用的，于是就顺着思路做了下去，有了这个比较完善的项目。
当前支持获取的性能数据包括GPU、CPU、内存、FPS、功耗、网络、温度，以及一系列手机硬件数据，并将根据需求继续新增。
本项目基于jlintxia开源的iOS测试方案修改而来，增加动态建表，动态增加grafana面板以及docker打包环境等特性。其中iOS性能数据来源于开源工具tidevice和py-ios-device。
注意：本项目依赖MySQL进行性能数据存储，Grafana进行数据动态展示，也就是说需要在本机或者可达的网络（比如公司局域网） 上搭建MySQL+Grafana服务，我提供了一份docker-compose.yml文件，可以使用docker快速搭建一套环境。
相关工具介绍 Grafana  Grafana是一个跨平台、开源的数据可视化网络应用程序平台。用户配置连接的数据源之后，Grafana可以在网络浏览器里显示数据图表和警告。该软件的企业版本提供更多的扩展功能。扩展功能通过插件的形式提供，终端用户可以自定义自己的数据面板界面以及数据请求方式。
 Mysql  MySQL原本是一个开放源码的关系数据库管理系统，原开发者为瑞典的MySQL AB公司，该公司于2008年被昇阳微系统收购。2009年，甲骨文公司收购昇阳微系统公司，MySQL成为Oracle旗下产品。
 py-ios-device  win，mac 跨平台方案，通过 Instruments 私有协议获取 iOS 相关性能指标数据。
相关文章链接:https://testerhome.com/topics/27159
 taobao-iphone-device  tidevice 是阿里的内部的一个小组用来做 iOS 自动化用的工具，通过逆向iOS通信协议，使用纯Python实现。目前淘宝和其他部分事业部已经全面使用了该技术，进行iOS应用的性能采集，UI自动化。
注：这里的被测应用无需做任何修改，使用不再局限于Mac上。
 使用步骤 准备工作 服务端搭建依赖docker以及docker-compose，安装指南：
 https://dockerdocs.cn/get-docker/
https://dockerdocs.cn/get-started/08_using_compose/
 运行测试依赖python3环境，安装指南：
 https://www.python.org/downloads/
 服务端搭建 命令行运行
docker -v && docker-compose -v 如果能正常输出版本，如下，则表示docker环境正常，可以继续
 Docker version 20.10.8, build 3967b7d
docker-compose version 1.29.2, build 5becea4c
 拉取镜像并启动服务：
docker-compose up -d 提示：初次打开Grafana时，系统会提示你修改密码，为了方便建议不修改，即保持账号密码均为admin，否则在python运行指令中将要进行对应的传参。"><meta property="og:type" content="article"><meta property="og:url" content="https://yanbo92.github.io/ios-perf/"><meta property="og:image" content="https://yanbo92.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="og:site_name" content="茅测顿开"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://yanbo92.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="腾讯性能狗收费之后，我写了一款iOS性能测试工具"><meta name=twitter:description content="运行效果 项目介绍 项目地址：yanbo92/iOS-perf
性能测试一直是APP测试的一个重要部分，而在Android上由于系统的开放特性，相关工具支持比较多，比如solopi等。但在iOS上，腾讯家的perfdog本来还是十分好用的，但收费了就有点难受，而直接用Xcode的Instruments又对Mac有刚需，很难支撑公司的测试需求。此时看到这个贴子，上手跑了几次，还挺好用的，于是就顺着思路做了下去，有了这个比较完善的项目。
当前支持获取的性能数据包括GPU、CPU、内存、FPS、功耗、网络、温度，以及一系列手机硬件数据，并将根据需求继续新增。
本项目基于jlintxia开源的iOS测试方案修改而来，增加动态建表，动态增加grafana面板以及docker打包环境等特性。其中iOS性能数据来源于开源工具tidevice和py-ios-device。
注意：本项目依赖MySQL进行性能数据存储，Grafana进行数据动态展示，也就是说需要在本机或者可达的网络（比如公司局域网） 上搭建MySQL+Grafana服务，我提供了一份docker-compose.yml文件，可以使用docker快速搭建一套环境。
相关工具介绍 Grafana  Grafana是一个跨平台、开源的数据可视化网络应用程序平台。用户配置连接的数据源之后，Grafana可以在网络浏览器里显示数据图表和警告。该软件的企业版本提供更多的扩展功能。扩展功能通过插件的形式提供，终端用户可以自定义自己的数据面板界面以及数据请求方式。
 Mysql  MySQL原本是一个开放源码的关系数据库管理系统，原开发者为瑞典的MySQL AB公司，该公司于2008年被昇阳微系统收购。2009年，甲骨文公司收购昇阳微系统公司，MySQL成为Oracle旗下产品。
 py-ios-device  win，mac 跨平台方案，通过 Instruments 私有协议获取 iOS 相关性能指标数据。
相关文章链接:https://testerhome.com/topics/27159
 taobao-iphone-device  tidevice 是阿里的内部的一个小组用来做 iOS 自动化用的工具，通过逆向iOS通信协议，使用纯Python实现。目前淘宝和其他部分事业部已经全面使用了该技术，进行iOS应用的性能采集，UI自动化。
注：这里的被测应用无需做任何修改，使用不再局限于Mac上。
 使用步骤 准备工作 服务端搭建依赖docker以及docker-compose，安装指南：
 https://dockerdocs.cn/get-docker/
https://dockerdocs.cn/get-started/08_using_compose/
 运行测试依赖python3环境，安装指南：
 https://www.python.org/downloads/
 服务端搭建 命令行运行
docker -v && docker-compose -v 如果能正常输出版本，如下，则表示docker环境正常，可以继续
 Docker version 20.10.8, build 3967b7d
docker-compose version 1.29.2, build 5becea4c
 拉取镜像并启动服务：
docker-compose up -d 提示：初次打开Grafana时，系统会提示你修改密码，为了方便建议不修改，即保持账号密码均为admin，否则在python运行指令中将要进行对应的传参。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"","item":"https://yanbo92.github.io/posts/"},{"@type":"ListItem","position":2,"name":"腾讯性能狗收费之后，我写了一款iOS性能测试工具","item":"https://yanbo92.github.io/ios-perf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"腾讯性能狗收费之后，我写了一款iOS性能测试工具","name":"腾讯性能狗收费之后，我写了一款iOS性能测试工具","description":"运行效果 项目介绍 项目地址：yanbo92/iOS-perf\n性能测试一直是APP测试的一个重要部分，而在Android上由于系统的开放特性，相关工具支持比较多，比如solopi等。但在iOS上，腾讯家的perfdog本来还是十分好用的，但收费了就有点难受，而直接用Xcode的Instruments又对Mac有刚需，很难支撑公司的测试需求。此时看到这个贴子，上手跑了几次，还挺好用的，于是就顺着思路做了下去，有了这个比较完善的项目。\n当前支持获取的性能数据包括GPU、CPU、内存、FPS、功耗、网络、温度，以及一系列手机硬件数据，并将根据需求继续新增。\n本项目基于jlintxia开源的iOS测试方案修改而来，增加动态建表，动态增加grafana面板以及docker打包环境等特性。其中iOS性能数据来源于开源工具tidevice和py-ios-device。\n注意：本项目依赖MySQL进行性能数据存储，Grafana进行数据动态展示，也就是说需要在本机或者可达的网络（比如公司局域网） 上搭建MySQL+Grafana服务，我提供了一份docker-compose.yml文件，可以使用docker快速搭建一套环境。\n相关工具介绍 Grafana  Grafana是一个跨平台、开源的数据可视化网络应用程序平台。用户配置连接的数据源之后，Grafana可以在网络浏览器里显示数据图表和警告。该软件的企业版本提供更多的扩展功能。扩展功能通过插件的形式提供，终端用户可以自定义自己的数据面板界面以及数据请求方式。\n Mysql  MySQL原本是一个开放源码的关系数据库管理系统，原开发者为瑞典的MySQL AB公司，该公司于2008年被昇阳微系统收购。2009年，甲骨文公司收购昇阳微系统公司，MySQL成为Oracle旗下产品。\n py-ios-device  win，mac 跨平台方案，通过 Instruments 私有协议获取 iOS 相关性能指标数据。\n相关文章链接:https://testerhome.com/topics/27159\n taobao-iphone-device  tidevice 是阿里的内部的一个小组用来做 iOS 自动化用的工具，通过逆向iOS通信协议，使用纯Python实现。目前淘宝和其他部分事业部已经全面使用了该技术，进行iOS应用的性能采集，UI自动化。\n注：这里的被测应用无需做任何修改，使用不再局限于Mac上。\n 使用步骤 准备工作 服务端搭建依赖docker以及docker-compose，安装指南：\n https://dockerdocs.cn/get-docker/\nhttps://dockerdocs.cn/get-started/08_using_compose/\n 运行测试依赖python3环境，安装指南：\n https://www.python.org/downloads/\n 服务端搭建 命令行运行\ndocker -v \u0026amp;\u0026amp; docker-compose -v 如果能正常输出版本，如下，则表示docker环境正常，可以继续\n Docker version 20.10.8, build 3967b7d\ndocker-compose version 1.29.2, build 5becea4c\n 拉取镜像并启动服务：\ndocker-compose up -d 提示：初次打开Grafana时，系统会提示你修改密码，为了方便建议不修改，即保持账号密码均为admin，否则在python运行指令中将要进行对应的传参。","keywords":["github","ios","开源项目","tidevice","iPhone","性能测试","grafana","mysql"],"articleBody":"运行效果 项目介绍 项目地址：yanbo92/iOS-perf\n性能测试一直是APP测试的一个重要部分，而在Android上由于系统的开放特性，相关工具支持比较多，比如solopi等。但在iOS上，腾讯家的perfdog本来还是十分好用的，但收费了就有点难受，而直接用Xcode的Instruments又对Mac有刚需，很难支撑公司的测试需求。此时看到这个贴子，上手跑了几次，还挺好用的，于是就顺着思路做了下去，有了这个比较完善的项目。\n当前支持获取的性能数据包括GPU、CPU、内存、FPS、功耗、网络、温度，以及一系列手机硬件数据，并将根据需求继续新增。\n本项目基于jlintxia开源的iOS测试方案修改而来，增加动态建表，动态增加grafana面板以及docker打包环境等特性。其中iOS性能数据来源于开源工具tidevice和py-ios-device。\n注意：本项目依赖MySQL进行性能数据存储，Grafana进行数据动态展示，也就是说需要在本机或者可达的网络（比如公司局域网） 上搭建MySQL+Grafana服务，我提供了一份docker-compose.yml文件，可以使用docker快速搭建一套环境。\n相关工具介绍 Grafana  Grafana是一个跨平台、开源的数据可视化网络应用程序平台。用户配置连接的数据源之后，Grafana可以在网络浏览器里显示数据图表和警告。该软件的企业版本提供更多的扩展功能。扩展功能通过插件的形式提供，终端用户可以自定义自己的数据面板界面以及数据请求方式。\n Mysql  MySQL原本是一个开放源码的关系数据库管理系统，原开发者为瑞典的MySQL AB公司，该公司于2008年被昇阳微系统收购。2009年，甲骨文公司收购昇阳微系统公司，MySQL成为Oracle旗下产品。\n py-ios-device  win，mac 跨平台方案，通过 Instruments 私有协议获取 iOS 相关性能指标数据。\n相关文章链接:https://testerhome.com/topics/27159\n taobao-iphone-device  tidevice 是阿里的内部的一个小组用来做 iOS 自动化用的工具，通过逆向iOS通信协议，使用纯Python实现。目前淘宝和其他部分事业部已经全面使用了该技术，进行iOS应用的性能采集，UI自动化。\n注：这里的被测应用无需做任何修改，使用不再局限于Mac上。\n 使用步骤 准备工作 服务端搭建依赖docker以及docker-compose，安装指南：\n https://dockerdocs.cn/get-docker/\nhttps://dockerdocs.cn/get-started/08_using_compose/\n 运行测试依赖python3环境，安装指南：\n https://www.python.org/downloads/\n 服务端搭建 命令行运行\ndocker -v \u0026\u0026 docker-compose -v 如果能正常输出版本，如下，则表示docker环境正常，可以继续\n Docker version 20.10.8, build 3967b7d\ndocker-compose version 1.29.2, build 5becea4c\n 拉取镜像并启动服务：\ndocker-compose up -d 提示：初次打开Grafana时，系统会提示你修改密码，为了方便建议不修改，即保持账号密码均为admin，否则在python运行指令中将要进行对应的传参。\n本地环境搭建 命令行执行\npip install -r requirements.txt 运行命令 命令行执行：\npython run.py --udid=00008110-001A4D483CF2801E \\ --bundleid=com.apple.Preferences \\ --grafana_host=localhost \\ --grafana_port=30000 \\ --grafana_user=admin \\ --grafana_password=admin \\ --mysql_host=localhost \\ --mysql_port=33306 \\ --mysql_username=root \\ --mysql_password=admin \\ --mysql_db=iOSPerformance 运行参数说明 建议修改参数   –bundleid：待测APP的包名，通过ideviceinstaller -l获取，默认值为com.apple.Preferences –udid iPhone：手机的唯一标识符，通过 idevice_id -l 获取，客户端只连接一台手机时不用写   Grafana可选参数   –grafana_host：Grafana的主机地址，只写ip，不用写Scheme，也就是http://或者https//，默认值localhost –grafana_port：Grafana的端口号，默认值30000 –grafana_user：Grafana的用户名，默认值admin –grafana_password：Grafana的密码，默认值admin   MySQL可选参数   –mysql_host：MySQL的主机地址，不用写Scheme，也就是http://或者https//，默认值localhost –mysql_port：MySQL的端口号，默认值33306 –mysql_user：MySQL的用户名，默认值root –mysql_password：MySQL的用户名，默认值admin   数据导出 命令行执行：\npython mysql.py --runid=iphone6_1008_1532 \\ --mysql_host=localhost \\ --mysql_port=33306 \\ --mysql_username=root \\ --mysql_password=admin \\ --mysql_db=iOSPerformance 其中，--runid为必须参数，可以从显示测试数据的Grafana页面的左上角找到，通常为手机名称+月日+时分。其余Mysql参数均为可选参数，默认值与上方MySQL可选参数相同。\n心得 Docker起服务实在是太方便了，grafana做可视化也很香。也很感慨现在测试开发方面的开源环境发展起来了，有很多现成的代码可以参考。\n参考文章 PerfDog | 移动全平台性能测试分析专家\n硬货来啦！！使用纯 python 实现 Instruments 协议，跨平台 (win,mac,linux) 获取 iOS 性能数据 · TesterHome\n新工具开源！一款iOS自动化利器（附地址）\n实时可视化 iOS 性能数据 tidevice+pyiosdevice+mysql+grafana · TesterHome\n","wordCount":"148","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"yanbo92"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yanbo92.github.io/ios-perf/"},"publisher":{"@type":"Organization","name":"茅测顿开","logo":{"@type":"ImageObject","url":"https://yanbo92.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://yanbo92.github.io/ accesskey=h title="首页 (Alt + H)">首页</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://yanbo92.github.io/categories/ title=分类><span>分类</span></a></li><li><a href=https://yanbo92.github.io/tags/ title=标签><span>标签</span></a></li><li><a href=https://yanbo92.github.io/search/ title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li><li><a href=https://github.com/yanbo92 title=Github><span>Github</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://yanbo92.github.io/>主页</a>&nbsp;»&nbsp;<a href=https://yanbo92.github.io/posts/></a></div><h1 class=post-title>腾讯性能狗收费之后，我写了一款iOS性能测试工具</h1><div class=post-meta>yanbo92
|&nbsp;<a href=https://github.com/yanbo92/yanbo92.github.io/tree/master/content/posts/ios-perf.md rel="noopener noreferrer" target=_blank>修改建议</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><div class=details>目录</div></summary><div class=inner><ul><li><a href=#%e8%bf%90%e8%a1%8c%e6%95%88%e6%9e%9c aria-label=运行效果>运行效果</a></li><li><a href=#%e9%a1%b9%e7%9b%ae%e4%bb%8b%e7%bb%8d aria-label=项目介绍>项目介绍</a></li><li><a href=#%e7%9b%b8%e5%85%b3%e5%b7%a5%e5%85%b7%e4%bb%8b%e7%bb%8d aria-label=相关工具介绍>相关工具介绍</a><ul><ul><li><a href=#grafanahttpsgrafanacom aria-label=Grafana><a href=https://grafana.com/>Grafana</a></a></li><li><a href=#mysqlhttpswwwmysqlcomcn aria-label=Mysql><a href=https://www.mysql.com/cn/>Mysql</a></a></li><li><a href=#py-ios-devicehttpsgithubcomyuechen-cpy-ios-device aria-label=py-ios-device><a href=https://github.com/YueChen-C/py-ios-device>py-ios-device</a></a></li><li><a href=#taobao-iphone-devicehttpsgithubcomalibabataobao-iphone-device aria-label=taobao-iphone-device><a href=https://github.com/alibaba/taobao-iphone-device>taobao-iphone-device</a></a></li></ul></ul></li><li><a href=#%e4%bd%bf%e7%94%a8%e6%ad%a5%e9%aa%a4 aria-label=使用步骤>使用步骤</a><ul><li><a href=#%e5%87%86%e5%a4%87%e5%b7%a5%e4%bd%9c aria-label=准备工作>准备工作</a><ul><li><a href=#%e6%9c%8d%e5%8a%a1%e7%ab%af%e6%90%ad%e5%bb%ba aria-label=服务端搭建>服务端搭建</a></li><li><a href=#%e6%9c%ac%e5%9c%b0%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba aria-label=本地环境搭建>本地环境搭建</a></li></ul></li><li><a href=#%e8%bf%90%e8%a1%8c%e5%91%bd%e4%bb%a4 aria-label=运行命令>运行命令</a><ul><li><a href=#%e8%bf%90%e8%a1%8c%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e aria-label=运行参数说明>运行参数说明</a><ul><li><a href=#%e5%bb%ba%e8%ae%ae%e4%bf%ae%e6%94%b9%e5%8f%82%e6%95%b0 aria-label=建议修改参数>建议修改参数</a></li><li><a href=#grafana%e5%8f%af%e9%80%89%e5%8f%82%e6%95%b0 aria-label=Grafana可选参数>Grafana可选参数</a></li><li><a href=#mysql%e5%8f%af%e9%80%89%e5%8f%82%e6%95%b0 aria-label=MySQL可选参数>MySQL可选参数</a></li></ul></li></ul></li><li><a href=#%e6%95%b0%e6%8d%ae%e5%af%bc%e5%87%ba aria-label=数据导出>数据导出</a></li></ul></li><li><a href=#%e5%bf%83%e5%be%97 aria-label=心得>心得</a></li><li><a href=#%e5%8f%82%e8%80%83%e6%96%87%e7%ab%a0 aria-label=参考文章>参考文章</a></li></ul></div></details></div><div class=post-content><h2 id=运行效果>运行效果<a hidden class=anchor aria-hidden=true href=#运行效果>#</a></h2><p><img loading=lazy src=/images/iOS-perf-1.png alt=ios-perf></p><h2 id=项目介绍>项目介绍<a hidden class=anchor aria-hidden=true href=#项目介绍>#</a></h2><p>项目地址：<a href=https://github.com/yanbo92/iOS-perf>yanbo92/iOS-perf</a></p><p>性能测试一直是APP测试的一个重要部分，而在<code>Android</code>上由于系统的开放特性，相关工具支持比较多，比如<code>solopi</code>等。但在<code>iOS</code>上，腾讯家的<code>perfdog</code>本来还是十分好用的，但收费了就有点难受，而直接用<code>Xcode</code>的<code>Instruments</code>又对Mac有刚需，很难支撑公司的测试需求。此时看到<a href=http://testerhome.com/topics/31066>这个贴子</a>，上手跑了几次，还挺好用的，于是就顺着思路做了下去，有了这个比较完善的项目。</p><p>当前支持获取的性能数据包括GPU、CPU、内存、FPS、功耗、网络、温度，以及一系列手机硬件数据，并将根据需求继续新增。</p><p>本项目基于jlintxia开源的iOS测试方案修改而来，增加动态建表，动态增加grafana面板以及docker打包环境等特性。其中iOS性能数据来源于开源工具tidevice和py-ios-device。</p><p>注意：本项目依赖MySQL进行性能数据存储，Grafana进行数据动态展示，也就是说需要在本机或者可达的网络（比如公司局域网） 上搭建MySQL+Grafana服务，我提供了一份docker-compose.yml文件，可以使用docker快速搭建一套环境。</p><h2 id=相关工具介绍>相关工具介绍<a hidden class=anchor aria-hidden=true href=#相关工具介绍>#</a></h2><h4 id=grafanahttpsgrafanacom><a href=https://grafana.com/>Grafana</a><a hidden class=anchor aria-hidden=true href=#grafanahttpsgrafanacom>#</a></h4><blockquote><p>Grafana是一个跨平台、开源的数据可视化网络应用程序平台。用户配置连接的数据源之后，Grafana可以在网络浏览器里显示数据图表和警告。该软件的企业版本提供更多的扩展功能。扩展功能通过插件的形式提供，终端用户可以自定义自己的数据面板界面以及数据请求方式。</p></blockquote><h4 id=mysqlhttpswwwmysqlcomcn><a href=https://www.mysql.com/cn/>Mysql</a><a hidden class=anchor aria-hidden=true href=#mysqlhttpswwwmysqlcomcn>#</a></h4><blockquote><p>MySQL原本是一个开放源码的关系数据库管理系统，原开发者为瑞典的MySQL AB公司，该公司于2008年被昇阳微系统收购。2009年，甲骨文公司收购昇阳微系统公司，MySQL成为Oracle旗下产品。</p></blockquote><h4 id=py-ios-devicehttpsgithubcomyuechen-cpy-ios-device><a href=https://github.com/YueChen-C/py-ios-device>py-ios-device</a><a hidden class=anchor aria-hidden=true href=#py-ios-devicehttpsgithubcomyuechen-cpy-ios-device>#</a></h4><blockquote><p>win，mac 跨平台方案，通过 Instruments 私有协议获取 iOS 相关性能指标数据。</p><p>相关文章链接:https://testerhome.com/topics/27159</p></blockquote><h4 id=taobao-iphone-devicehttpsgithubcomalibabataobao-iphone-device><a href=https://github.com/alibaba/taobao-iphone-device>taobao-iphone-device</a><a hidden class=anchor aria-hidden=true href=#taobao-iphone-devicehttpsgithubcomalibabataobao-iphone-device>#</a></h4><blockquote><p>tidevice 是阿里的内部的一个小组用来做 iOS 自动化用的工具，通过逆向iOS通信协议，使用纯Python实现。目前淘宝和其他部分事业部已经全面使用了该技术，进行iOS应用的性能采集，UI自动化。</p><p>注：这里的被测应用无需做任何修改，使用不再局限于Mac上。</p></blockquote><h2 id=使用步骤>使用步骤<a hidden class=anchor aria-hidden=true href=#使用步骤>#</a></h2><h3 id=准备工作>准备工作<a hidden class=anchor aria-hidden=true href=#准备工作>#</a></h3><p>服务端搭建依赖docker以及docker-compose，安装指南：</p><blockquote><p><a href=https://dockerdocs.cn/get-docker/>https://dockerdocs.cn/get-docker/</a></p><p><a href=https://dockerdocs.cn/get-started/08_using_compose/>https://dockerdocs.cn/get-started/08_using_compose/</a></p></blockquote><p>运行测试依赖python3环境，安装指南：</p><blockquote><p><a href=https://www.python.org/downloads/>https://www.python.org/downloads/</a></p></blockquote><h4 id=服务端搭建>服务端搭建<a hidden class=anchor aria-hidden=true href=#服务端搭建>#</a></h4><p>命令行运行</p><pre tabindex=0><code>docker -v &amp;&amp; docker-compose -v
</code></pre><p>如果能正常输出版本，如下，则表示docker环境正常，可以继续</p><blockquote><p>Docker version 20.10.8, build 3967b7d</p><p>docker-compose version 1.29.2, build 5becea4c</p></blockquote><p>拉取镜像并启动服务：</p><pre tabindex=0><code>docker-compose up -d  
</code></pre><p><strong>提示：初次打开<code>Grafana</code>时，系统会提示你修改密码，为了方便建议不修改，即保持账号密码均为<code>admin</code>，否则在python运行指令中将要进行对应的传参。</strong></p><h4 id=本地环境搭建>本地环境搭建<a hidden class=anchor aria-hidden=true href=#本地环境搭建>#</a></h4><p>命令行执行</p><pre tabindex=0><code>pip install -r requirements.txt
</code></pre><h3 id=运行命令>运行命令<a hidden class=anchor aria-hidden=true href=#运行命令>#</a></h3><p>命令行执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>python run.py --udid<span class=o>=</span>00008110-001A4D483CF2801E <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--bundleid<span class=o>=</span>com.apple.Preferences <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--grafana_host<span class=o>=</span>localhost <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--grafana_port<span class=o>=</span><span class=m>30000</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--grafana_user<span class=o>=</span>admin <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--grafana_password<span class=o>=</span>admin <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--mysql_host<span class=o>=</span>localhost <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--mysql_port<span class=o>=</span><span class=m>33306</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--mysql_username<span class=o>=</span>root <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--mysql_password<span class=o>=</span>admin <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--mysql_db<span class=o>=</span>iOSPerformance
</span></span></code></pre></div><h4 id=运行参数说明>运行参数说明<a hidden class=anchor aria-hidden=true href=#运行参数说明>#</a></h4><h5 id=建议修改参数>建议修改参数<a hidden class=anchor aria-hidden=true href=#建议修改参数>#</a></h5><blockquote><ul><li>&ndash;bundleid：待测APP的包名，通过<code>ideviceinstaller -l</code>获取，默认值为<code>com.apple.Preferences</code></li><li>&ndash;udid iPhone：手机的唯一标识符，通过 <code>idevice_id -l</code> 获取，客户端只连接一台手机时不用写</li></ul></blockquote><h5 id=grafana可选参数>Grafana可选参数<a hidden class=anchor aria-hidden=true href=#grafana可选参数>#</a></h5><blockquote><ul><li>&ndash;grafana_host：Grafana的主机地址，只写ip，不用写Scheme，也就是<code>http://</code>或者<code>https//</code>，默认值localhost</li><li>&ndash;grafana_port：Grafana的端口号，默认值30000</li><li>&ndash;grafana_user：Grafana的用户名，默认值admin</li><li>&ndash;grafana_password：Grafana的密码，默认值admin</li></ul></blockquote><h5 id=mysql可选参数>MySQL可选参数<a hidden class=anchor aria-hidden=true href=#mysql可选参数>#</a></h5><blockquote><ul><li>&ndash;mysql_host：MySQL的主机地址，不用写Scheme，也就是<code>http://</code>或者<code>https//</code>，默认值localhost</li><li>&ndash;mysql_port：MySQL的端口号，默认值33306</li><li>&ndash;mysql_user：MySQL的用户名，默认值root</li><li>&ndash;mysql_password：MySQL的用户名，默认值admin</li></ul></blockquote><h3 id=数据导出>数据导出<a hidden class=anchor aria-hidden=true href=#数据导出>#</a></h3><p>命令行执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>python mysql.py --runid<span class=o>=</span>iphone6_1008_1532 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--mysql_host<span class=o>=</span>localhost <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--mysql_port<span class=o>=</span><span class=m>33306</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--mysql_username<span class=o>=</span>root <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--mysql_password<span class=o>=</span>admin <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--mysql_db<span class=o>=</span>iOSPerformance
</span></span></code></pre></div><p>其中，<code>--runid</code>为必须参数，可以从显示测试数据的Grafana页面的左上角找到，通常为手机名称+月日+时分。其余Mysql参数均为可选参数，默认值与上方<a href=#MySQL%E5%8F%AF%E9%80%89%E5%8F%82%E6%95%B0>MySQL可选参数</a>相同。</p><h2 id=心得>心得<a hidden class=anchor aria-hidden=true href=#心得>#</a></h2><p>Docker起服务实在是太方便了，grafana做可视化也很香。也很感慨现在测试开发方面的开源环境发展起来了，有很多现成的代码可以参考。</p><h2 id=参考文章>参考文章<a hidden class=anchor aria-hidden=true href=#参考文章>#</a></h2><p><a href=https://perfdog.qq.com/>PerfDog | 移动全平台性能测试分析专家</a></p><p><a href=https://testerhome.com/topics/27159>硬货来啦！！使用纯 python 实现 Instruments 协议，跨平台 (win,mac,linux) 获取 iOS 性能数据 · TesterHome</a></p><p><a href=https://tech.taobao.org/news/lxhg5l>新工具开源！一款iOS自动化利器（附地址）</a></p><p><a href=http://testerhome.com/topics/31066>实时可视化 iOS 性能数据 tidevice+pyiosdevice+mysql+grafana · TesterHome</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://yanbo92.github.io/tags/github/>github</a></li><li><a href=https://yanbo92.github.io/tags/ios/>ios</a></li><li><a href=https://yanbo92.github.io/tags/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/>开源项目</a></li><li><a href=https://yanbo92.github.io/tags/tidevice/>tidevice</a></li><li><a href=https://yanbo92.github.io/tags/iphone/>iPhone</a></li><li><a href=https://yanbo92.github.io/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/>性能测试</a></li><li><a href=https://yanbo92.github.io/tags/grafana/>grafana</a></li><li><a href=https://yanbo92.github.io/tags/mysql/>mysql</a></li></ul><nav class=paginav><a class=next href=https://yanbo92.github.io/fastbot-stub-inject/><span class=title>下一页 »</span><br><span>使用yololib注入fastbot-stub并重签名运行测试</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://yanbo92.github.io/>茅测顿开</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById("menu").scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById("menu").scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>